pipeline:
  frontend:
    image: node:8.11.2-alpine
    commands: 
      - npm install
      - npm run test
      - npm run build
    when:
      branch: master
  s3-sync:
    image: plugins/s3-sync:1
    region: us-west-2
    bucket: dev.merqbiz.com
    source: public
    target: /
    acl:
      "*": public-read
    content_encoding:
      ".js": gzip
      ".css": gzip
    cloudfront_distribution: E1CH3B6EW4M6KZ
    secrets: [ aws_access_key_id, aws_secret_access_key ]
  notify:
    image: plugins/slack
    username: merqbizbuddyhoward
    channel: sandbox_tran
    secrets: [ slack_webhook ]